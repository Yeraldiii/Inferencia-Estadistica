hist(vidrio,col="steelblue")
qqnorm(vidrio,main="QQ plot para distribucion normal",
xlab="cuantiles teoricos",ylab="Cuantiles muestrales")
qqline(vidrio, distribution=qnorm,col="green2", lty=2,lwd=2)
# Estime P(X<2.8)
n=12
pnorm(2.8,mean(vidrio),(var(vidrio)*(n-1)/n)^0.5)
n=5:300
est.mean=c()
est.var=c()
for(i in 1:length(n)){
x=rpois(n[i],5)
est.mean[i]=mean(x)
est.var[i]=var(x)*(n[i]-1)/n[i]
}
est1.mean=c()
est1.var=c()
for(i in 1:length(n)){
y=rpois(n[i],15)
est1.mean[i]=mean(y)
est1.var[i]=var(y)*(n[i]-1)/n[i]
}
par(mfrow=c(1,2))
plot(n,est.var,xlab="n",ylab="Estimacion",
main="Poblacion Poisson(5)",
type="l",col="green2",ylim=c(0,12))
abline(h=5)
lines(n,est.mean,col="tomato")
legend(100,11,c("Media","Varianza"),lty=c(1,1),
col=c("tomato","green2"),box.col = 0)
plot(n,est1.var,xlab="n",ylab="Estimacion",
main="Poblacion Poisson(15)",ylim=c(0,45),
type="l",col="green2")
abline(h=15)
lines(n,est1.mean,col="tomato")
legend(130,38,c("Media","Varianza"),lty=c(1,1),
col=c("tomato","green2"),box.col = 0)
set.seed(456)
n=5:300
est.mome=rep(NA,length(n))
est.maxv=rep(NA,length(n))
for(i in 1:length(n)){
x=runif(n[i],0,3)
est.mome[i]=2*mean(x)
est.maxv[i]=max(x)
}
est1.mome=rep(NA,length(n))
est1.maxv=rep(NA,length(n))
for(i in 1:length(n)){
y=runif(n[i],0,5)
est1.mome[i]=2*mean(y)
est1.maxv[i]=max(y)
}
par(mfrow=c(1,2))
plot(n,est.maxv,xlab="n",ylab="Estimacion",
main="Poblacion Uniforme(0,3)",
type="l",col="tomato",ylim=c(2,4.5))
abline(3,0)
lines(n,est.mome,col="green2")
legend(110,4.2,c("Max. Vero","Momentos"),lty=c(1,1),
col=c("tomato","green2"),box.col = 0)
plot(n,est1.maxv,xlab="n",ylab="Estimacion",
main="Poblacion Uniforme(0,5)",
type="l",col="tomato",ylim=c(2,7))
abline(5,0)
lines(n,est1.mome,col="green2")
legend(105,6.5,c("Max. Vero","Momentos"),lty=c(1,1),
col=c("tomato","green2"),box.col = 0)
rm(list=ls())
## Generando datos para una distribucion Burr
rBurr=function(n,c,k) (((1-runif(n))^(-1/k))-1)^(1/c)
n=1000;k=1;c=3
xBurr=rBurr(n,c,k)
mean(xBurr)
(mu1=k*beta(k-1/c,1+1/c))
(mu2=k*beta(k-2/c,1+2/c))
var(xBurr)
mu2-mu1^2
# derivada parcial del log(L) con respecto a c (reemplazando k)
c.parm=function(c) n/c+sum(log(xBurr))-
(n/sum(log(1+xBurr^c))+1)*sum((log(xBurr)*xBurr^c)/(1+xBurr^c))
### PRIMERA MANERA: Con la funcion uniroot
# resolviendo para c
c.mle=uniroot(c.parm,c(0,100))$root
# poniendo el estimador maximo verosimil de c en la derivada parcial de log(L)
# con respecto a k
k.mle=n/sum(log(1+xBurr^c.mle))
# Estimadores Maximo Verosimiles para la Distribucion Burr
c(k.mle,c.mle)
### SEGUNDA MANERA: Con la funcion mle de la libreria stats4
## Otra manera de generar datos de la distribucion Burr
set.seed(1)
library(extremefit)
x=rburr(n,a=3,k=1)
head(x)
##   -log(L)
lBurr=function(a,k)
{
n=length(x)
c=a
k1=k
(-n*log(c)-n*log(k1)-(c-1)*sum(log(x))+(k1+1)*sum(log(1+x^c)))
}
library(stats4)
estBurr=mle(minuslogl=lBurr,start = list(a=2.8,k=0.9))
summary(estBurr)
for(i in 1:nSim) {
x = rweibull3(n,shape=mu,scale=theta,thres=r)
theta_hat1[i] = (sum((x-r)^mu)/n)^(1/mu)
}
(muSimEstim=mean(theta_hat1)) # Media simulada
(varSimEstim=var(theta_hat1)) # Varianza simulada
# Histograma y distribucion aproximada
library(tidyverse)
df <- tibble(theta_hat1)
# Haciendo simulaciones
n = 150
theta = 4 # scale
mu = 2    # shape
r = 3
theta^2/(n*mu^2)
nSim = 10^5
theta_hat1 = numeric(nSim)
library(FAdist)
for(i in 1:nSim) {
x = rweibull3(n,shape=mu,scale=theta,thres=r)
theta_hat1[i] = (sum((x-r)^mu)/n)^(1/mu)
}
(muSimEstim=mean(theta_hat1)) # Media simulada
(varSimEstim=var(theta_hat1)) # Varianza simulada
# Histograma y distribucion aproximada
library(tidyverse)
df <- tibble(theta_hat1)
#----------------
# Graficos - hist & density
ggplot(df, aes(x = theta_hat1))  +
geom_histogram(aes(y = after_stat(density)),fill='steelblue' ,bins = 10, color = "white") +
stat_function(fun = dnorm, args = list(mean = theta, sd = sqrt(theta^2/(n*mu^2))),col='green2',lwd=0.8) +
scale_x_continuous(breaks = c(theta - 3*sqrt(theta^2/(n*mu^2)), theta + 3*sqrt(theta^2/(n*mu^2))))+
geom_vline(xintercept = theta, color = 'tomato', lty = 2, lwd = 0.8)+
labs(x = "theta_hat", y = "Densidad")
# Intervalo de confianza con una muestra particular
n = 150
#----------------
# Graficos - hist & density
ggplot(df, aes(x = theta_hat1))  +
geom_histogram(aes(y = after_stat(density)),fill='steelblue' ,bins = 10, color = "white") +
stat_function(fun = dnorm, args = list(mean = theta, sd = sqrt(theta^2/(n*mu^2))),col='green2',lwd=0.8) +
scale_x_continuous(breaks = c(theta - 3*sqrt(theta^2/(n*mu^2)), theta + 3*sqrt(theta^2/(n*mu^2))))+
geom_vline(xintercept = theta, color = 'tomato', lty = 2, lwd = 0.8)+
labs(x = "theta_hat", y = "Densidad")
#----------------
# Graficos - hist & density
ggplot(df, aes(x = theta_hat1))  +
geom_histogram(aes(y = after_stat(density)),fill='steelblue' ,bins = 10, color = "white") +
stat_function(fun = dnorm, args = list(mean = theta, sd = sqrt(theta^2/(n*mu^2))),col='green2',lwd=0.8) +
scale_x_continuous(breaks = c(theta - 3*sqrt(theta^2/(n*mu^2)), theta + 3*sqrt(theta^2/(n*mu^2))))+
geom_vline(xintercept = theta, color = 'tomato', lty = 2, lwd = 0.8)+
labs(x = "theta_hat", y = "Densidad")
= theta, sd = sqrt(theta^2/(n*mu^2))),col='green2',lwd=0.8) +
# Intervalo de confianza con una muestra particular
n = 150
muestra = rweibull3(n,shape=mu,scale=theta,thres=r)
(theta_hat = (sum((muestra-r)^mu)/n)^(1/mu))
alpha = 0.05
(LI = theta_hat - qnorm(1-alpha/2)*sqrt(theta_hat^2/(n*mu^2)))
(LS = theta_hat + qnorm(1-alpha/2)*sqrt(theta_hat^2/(n*mu^2)))
# Prueba de hipótesis
# H0: theta = theta0 = 5
# H0: theta != theta0 = 5
theta0 = 5
(Zc = (theta_hat - theta0) / sqrt(theta0^2/(n*mu^2)))
(pvalor = 2*pnorm(abs(Zc), lower.tail = F))
# Haciendo simulaciones
n = 120
lambda = 8
# Haciendo simulaciones
n = 120
lambda = 8
lambda^2/n
nSim = 10^5
lambda_hat1 = numeric(nSim)
for(i in 1:nSim) {
x = rbeta(n, shape1 = 8, shape2 = 1)
lambda_hat1[i] = -n/sum(log(x))
}
(muSimEstim=mean(lambda_hat1)) # Media simulada
(varSimEstim=var(lambda_hat1)) # Varianza simulada
# Histograma y distribucion aproximada
library(tidyverse)
df <- tibble(lambda_hat1)
#----------------
# Graficos - hist & density
ggplot(df, aes(x = lambda_hat1))  +
geom_histogram(aes(y = after_stat(density)),fill='steelblue' ,bins = 10, color = "white") +
stat_function(fun = dnorm, args = list(mean = lambda, sd = sqrt(lambda^2/n)),col='green2',lwd=0.8) +
scale_x_continuous(breaks = c(lambda - 3*sqrt(lambda^2/n), lambda + 3*sqrt(lambda^2/n)))+
geom_vline(xintercept = lambda, color = 'tomato', lty = 2, lwd = 0.8)+
labs(x = "lambda_hat", y = "Densidad")
#----------------
# Graficos - hist & density
ggplot(df, aes(x = lambda_hat1))  +
geom_histogram(aes(y = after_stat(density)),fill='steelblue' ,bins = 10, color = "white") +
stat_function(fun = dnorm, args = list(mean = lambda, sd = sqrt(lambda^2/n)),col='green2',lwd=0.8) +
scale_x_continuous(breaks = c(lambda - 3*sqrt(lambda^2/n), lambda + 3*sqrt(lambda^2/n)))+
geom_vline(xintercept = lambda, color = 'tomato', lty = 2, lwd = 0.8)+
labs(x = "lambda_hat", y = "Densidad")
# Con una muestra particular
# Ejemplo-b
n = 120
muestra = rbeta(n, shape1 = 8, shape2 = 1)
(lambda_hat = -n/sum(log(muestra)))
alpha = 0.05
(LI = lambda_hat - qnorm(1-alpha/2)*sqrt(lambda_hat^2/n))
(LS = lambda_hat + qnorm(1-alpha/2)*sqrt(lambda_hat^2/n))
# Ejemplo-c
# H0: lambda = lambda0 = 10
lambda0 = 10
(Zc = (lambda_hat - lambda0) / sqrt(lambda0^2/n))
(pvalor = 2*pnorm(abs(Zc), lower.tail = F))
# Haciendo simulaciones
n = 120
lambda = 8
lambda^2/n
nSim = 10^5
lambda_hat1 = numeric(nSim)
for(i in 1:nSim) {
x = rbeta(n, shape1 = 8, shape2 = 1)
lambda_hat1[i] = -n/sum(log(x))
}
(muSimEstim=mean(lambda_hat1)) # Media simulada
(varSimEstim=var(lambda_hat1)) # Varianza simulada
# Histograma y distribucion aproximada
library(tidyverse)
df <- tibble(lambda_hat1)
#----------------
# Graficos - hist & density
ggplot(df, aes(x = lambda_hat1))  +
geom_histogram(aes(y = after_stat(density)),fill='steelblue' ,bins = 10, color = "white") +
stat_function(fun = dnorm, args = list(mean = lambda, sd = sqrt(lambda^2/n)),col='green2',lwd=0.8) +
scale_x_continuous(breaks = c(lambda - 3*sqrt(lambda^2/n), lambda + 3*sqrt(lambda^2/n)))+
geom_vline(xintercept = lambda, color = 'tomato', lty = 2, lwd = 0.8)+
labs(x = "lambda_hat", y = "Densidad")
# Con una muestra particular
# Ejemplo-b
n = 120
muestra = rbeta(n, shape1 = 8, shape2 = 1)
(lambda_hat = -n/sum(log(muestra)))
alpha = 0.05
(LI = lambda_hat - qnorm(1-alpha/2)*sqrt(lambda_hat^2/n))
(LS = lambda_hat + qnorm(1-alpha/2)*sqrt(lambda_hat^2/n))
# Ejemplo-c
# H0: lambda = lambda0 = 10
lambda0 = 10
(Zc = (lambda_hat - lambda0) / sqrt(lambda0^2/n))
(pvalor = 2*pnorm(abs(Zc), lower.tail = F))
# 1) PARÁMETROS DEL PROBLEMA
N <- 8              # tamaño de la población
n <- 4              # tamaño de la muestra
x_obs <- 2          # valor observado de X
# Espacio paramétrico
theta_vals <- seq(0, 1, by = 1/8)   # 0, 1/8, ..., 1
A_vals <- N * theta_vals            # Número de éxitos en población: 0,1,...,8
# -------------------------------------------------------------
# 2) FUNCIÓN DE MASA DE PROBABILIDAD - DISTRIBUCIÓN V
# Fórmula: P(X=x) = [C(A+x-1, x) * C(N-A+n-x-1, n-x)] / C(N+n-1, n)
# -------------------------------------------------------------
pmf_V <- function(A, N, n, x){
if(A < 0 || A > N) return(0)
a1 <- A + x - 1
a2 <- x
b1 <- (N - A) + (n - x) - 1
b2 <- n - x
if(a1 < a2 || b1 < b2) return(0)
if(a2 < 0 || b2 < 0) return(0)
num1 <- choose(a1, a2)
num2 <- choose(b1, b2)
den  <- choose(N + n - 1, n)
return((num1 * num2) / den)
}
# -------------------------------------------------------------
# 3) CÁLCULO DE VEROSIMILITUDES
# -------------------------------------------------------------
likelihoods <- sapply(A_vals, pmf_V, N = N, n = n, x = x_obs)
# Tabla de resultados mejorada
resultados <- data.frame(
Theta = theta_vals,
A = A_vals,
L_Theta = round(likelihoods, 6),
L_Relativa = round(likelihoods / max(likelihoods), 4)
)
print("Tabla de Verosimilitudes:")
print(resultados)
cat("\n")
# -------------------------------------------------------------
# 4) ESTIMACIÓN MÁXIMO VEROSÍMIL
# -------------------------------------------------------------
ind_max <- which.max(likelihoods)
EMV_A <- A_vals[ind_max]
EMV_theta <- theta_vals[ind_max]
L_max <- likelihoods[ind_max]
cat("══════════════════════════════════════════════════════\n")
cat("           ESTIMACIÓN POR MÁXIMA VEROSIMILITUD\n")
cat("══════════════════════════════════════════════════════\n")
cat("• Población total (N) =", N, "porciones\n")
cat("• Muestra tomada (n) =", n, "porciones\n")
cat("• Valor observado (x) =", x_obs, "\n")
cat("• Distribución: V (muestreo con reemplazo)\n")
cat("• EMV de A =", EMV_A, "\n")
cat("• EMV de θ =", EMV_theta, "\n")
cat("• Máxima verosimilitud =", round(L_max, 6), "\n")
cat("══════════════════════════════════════════════════════\n\n")
# -------------------------------------------------------------
# 5) GRÁFICO
# -------------------------------------------------------------
par(mfrow = c(1, 1), mar = c(5, 4, 4, 2))
plot(theta_vals, likelihoods,
type = "h",
lwd = 8,
col = "steelblue",
lend = 2,
xlab = expression(theta),
ylab = "L(θ)",
main = expression("Función de Verosimilitud L(θ) para X ~ V(N=8, n=4, x=2)"),
cex.main = 0.9,
ylim = c(0, max(likelihoods) * 1.1))
# Punto del EMV
points(EMV_theta, L_max,
pch = 21,
bg = "gold",
col = "darkred",
cex = 2,
lwd = 2)
# Texto del EMV
text(EMV_theta, L_max,
labels = paste("EMV =", EMV_theta),
pos = 3,
col = "darkred",
font = 2)
# Líneas de guía
abline(v = EMV_theta, col = "orange", lty = 2, lwd = 1.5)
abline(h = L_max, col = "orange", lty = 2, lwd = 1.5)
# Etiquetas de puntos
for(i in seq_along(theta_vals)){
if(likelihoods[i] > 0){
text(theta_vals[i], likelihoods[i],
labels = round(likelihoods[i], 4),
pos = 3,
cex = 0.7,
col = "navy")
}
}
grid(col = "gray80", lty = 2)
# -------------------------------------------------------------
# 1) PARÁMETROS DEL PROBLEMA
# -------------------------------------------------------------
N <- 8              # tamaño de la población
n <- 4              # tamaño de la muestra
x_obs <- 2          # valor observado de X (CAMBIAR si corresponde)
# Espacio paramétrico de theta y A
theta_vals <- seq(0, 1, by = 1/8)   # 0, 1/8, ..., 1
A_vals <- N * theta_vals            # 0,1,2,...,8
# -------------------------------------------------------------
# 2) DEFINIR LA PMF DE LA DISTRIBUCIÓN V (CON VALIDACIONES)
#    f(x | A) = [C(A+x-1, x) * C((N-A)+(n-x)-1, n-x)] / C(N+n-1, n)
# -------------------------------------------------------------
pmf_V <- function(A, N, n, x){
# argumentos combinatorios
a1 <- A + x - 1;   a2 <- x
b1 <- (N - A) + (n - x) - 1;   b2 <- n - x
# validaciones para evitar combinaciones inválidas
if(A < 0 || A > N) return(0)
if(a1 < a2 || b1 < b2) return(0)
if(a2 < 0 || b2 < 0) return(0)
# combinación válida
num1 <- choose(a1, a2)
num2 <- choose(b1, b2)
den  <- choose(N + n - 1, n)
return((num1 * num2) / den)
}
# -------------------------------------------------------------
# 3) CALCULAR LA FUNCIÓN DE VEROSIMILITUD PARA CADA A
# -------------------------------------------------------------
likelihoods <- sapply(A_vals, pmf_V, N = N, n = n, x = x_obs)
# Tabla con resultados
tabla_resultados <- data.frame(
Theta = theta_vals,
A = A_vals,
Verosimilitud = likelihoods,
Verosimilitud_Relativa = likelihoods / max(likelihoods)
)
print(tabla_resultados)
# -------------------------------------------------------------
# 4) ESTIMADOR DE MÁXIMA VEROSIMILITUD (EMV / MLE)
# -------------------------------------------------------------
indice_max <- which.max(likelihoods)
EMV_A <- A_vals[indice_max]
EMV_theta <- theta_vals[indice_max]
L_max <- likelihoods[indice_max]
cat("\n====================================================\n")
cat("                 RESULTADO DEL EMV\n")
cat("====================================================\n")
cat("Valor observado: x =", x_obs, "\n")
cat("EMV de A:", EMV_A, "\n")
cat("EMV de theta:", EMV_theta, "\n")
cat("Verosimilitud máxima:", L_max, "\n")
cat("====================================================\n\n")
# -------------------------------------------------------------
# 5) GRÁFICA DE LA FUNCIÓN DE VEROSIMILITUD
# -------------------------------------------------------------
plot(theta_vals, likelihoods, type = "h", lwd = 5, col = "black",
main = "Función de Verosimilitud L(theta) - Distribución V",
xlab = expression(theta), ylab = "L(theta)")
points(EMV_theta, L_max, pch = 19, cex = 2, col = "hotpink")
text(EMV_theta, L_max, labels = paste("EMV =", EMV_theta), pos = 3, col = "red")
# -------------------------------------------------------------
# 5) GRÁFICA DE LA FUNCIÓN DE VEROSIMILITUD
# -------------------------------------------------------------
plot(theta_vals, likelihoods, type = "h", lwd = 5, col = "black",
main = "Función de Verosimilitud L(theta) - Distribución V",
xlab = expression(theta), ylab = "L(theta)")
points(EMV_theta, L_max, pch = 19, cex = 2, col = "hotpink")
text(EMV_theta, L_max, labels = paste("EMV =", EMV_theta), pos = 3, col = "red")
cat("EMV de A:", EMV_A, "\n")
cat("EMV de theta:", EMV_theta, "\n")
cat("Verosimilitud máxima:", L_max, "\n")
# 1) PARÁMETROS DEL PROBLEMA
N <- 8              # tamaño de la población
n <- 4              # tamaño de la muestra
x_obs <- 2          # valor observado de X
# Espacio paramétrico
theta_vals <- seq(0, 1, by = 1/8)   # 0, 1/8, ..., 1
A_vals <- N * theta_vals            # Número de éxitos en población: 0,1,...,8
# -------------------------------------------------------------
# 2) FUNCIÓN DE MASA DE PROBABILIDAD - DISTRIBUCIÓN V
# Fórmula: P(X=x) = [C(A+x-1, x) * C(N-A+n-x-1, n-x)] / C(N+n-1, n)
# -------------------------------------------------------------
pmf_V <- function(A, N, n, x){
if(A < 0 || A > N) return(0)
a1 <- A + x - 1
a2 <- x
b1 <- (N - A) + (n - x) - 1
b2 <- n - x
if(a1 < a2 || b1 < b2) return(0)
if(a2 < 0 || b2 < 0) return(0)
num1 <- choose(a1, a2)
num2 <- choose(b1, b2)
den  <- choose(N + n - 1, n)
return((num1 * num2) / den)
}
# -------------------------------------------------------------
# 3) CÁLCULO DE VEROSIMILITUDES
# -------------------------------------------------------------
likelihoods <- sapply(A_vals, pmf_V, N = N, n = n, x = x_obs)
# Tabla de resultados mejorada
resultados <- data.frame(
Theta = theta_vals,
A = A_vals,
L_Theta = round(likelihoods, 6),
L_Relativa = round(likelihoods / max(likelihoods), 4)
)
print("Tabla de Verosimilitudes:")
print(resultados)
cat("\n")
# -------------------------------------------------------------
# 4) ESTIMACIÓN MÁXIMO VEROSÍMIL
# -------------------------------------------------------------
ind_max <- which.max(likelihoods)
EMV_A <- A_vals[ind_max]
EMV_theta <- theta_vals[ind_max]
L_max <- likelihoods[ind_max]
cat("══════════════════════════════════════════════════════\n")
cat("           ESTIMACIÓN POR MÁXIMA VEROSIMILITUD\n")
cat("══════════════════════════════════════════════════════\n")
cat("• Población total (N) =", N, "porciones\n")
cat("• Muestra tomada (n) =", n, "porciones\n")
cat("• Valor observado (x) =", x_obs, "\n")
cat("• Distribución: V (muestreo con reemplazo)\n")
cat("• EMV de A =", EMV_A, "\n")
cat("• EMV de θ =", EMV_theta, "\n")
cat("• Máxima verosimilitud =", round(L_max, 6), "\n")
cat("══════════════════════════════════════════════════════\n\n")
# -------------------------------------------------------------
# 5) GRÁFICO
# -------------------------------------------------------------
par(mfrow = c(1, 1), mar = c(5, 4, 4, 2))
plot(theta_vals, likelihoods,
type = "h",
lwd = 8,
col = "steelblue",
lend = 2,
xlab = expression(theta),
ylab = "L(θ)",
main = expression("Función de Verosimilitud L(θ) para X ~ V(N=8, n=4, x=2)"),
cex.main = 0.9,
ylim = c(0, max(likelihoods) * 1.1))
# Punto del EMV
points(EMV_theta, L_max,
pch = 21,
bg = "gold",
col = "darkred",
cex = 2,
lwd = 2)
# Texto del EMV
text(EMV_theta, L_max,
labels = paste("EMV =", EMV_theta),
pos = 3,
col = "darkred",
font = 2)
# Líneas de guía
abline(v = EMV_theta, col = "orange", lty = 2, lwd = 1.5)
abline(h = L_max, col = "orange", lty = 2, lwd = 1.5)
